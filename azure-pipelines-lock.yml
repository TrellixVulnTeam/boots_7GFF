jobs:
  - template: azure/templates/jobs/get_in_archive.yml
    parameters:
      job: get_input_archive

  - template: azure/templates/jobs/lock.yml
    parameters:
      platform: Linux
      vmImage: 'ubuntu-16.04'
      dependsOn: get_input_archive

  - template: azure/templates/jobs/lock.yml
    parameters:
      platform: macOS
      vmImage: 'macOS-10.13'
      dependsOn: get_input_archive

  - template: azure/templates/jobs/lock.yml
    parameters:
      platform: Windows
      vmImage: 'vs2017-win2016'
      dependsOn: get_input_archive
  - job: collect
    displayName: Collect all lock files
    dependsOn: *
    steps:
      - task: DownloadPipelineArtifact@0
        inputs:
          artifactName: ''
          itemPattern: 'lock*/**'
          targetPath: $(System.DefaultWorkingDirectory)
      - bash: |
          ls -la
