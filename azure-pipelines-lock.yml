jobs:
  - job: lock
    displayName: pip-compile requirements
    pool:
      vmImage: 'ubuntu-16.04'
    steps:
      - task: UsePythonVersion@0
        inputs:
          versionSpec: '3.6'
          architecture: 'x64'
      - bash: |
          curl --silent --show-error '$(BOOTS_ARCHIVE_URL)' | tar --extract --verbose
          python boots.py lock
          tar --create --gzip --file locked.tar.gz requirements/*.txt
      - task: PublishPipelineArtifact@0
        inputs:
          artifactName: 'locked'
          targetPath: '$(System.DefaultWorkingDirectory)/locked.tar.gz'
